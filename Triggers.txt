Create table LIBRARY (
BOOK_ID number, BOOK_NAME Varchar2(10), BOOK_PRICE number
);

Create table LIBRARY_AUDIT_ROW (
BOOK_ID number, AUDIT_CHANGE Varchar2(20),
BOOK_NAME Varchar2(10), BOOK_PRICE number, UPDATE_TIME Date
);

insert into LIBRARY Values ( 1, 'BOOK1', 500 );
insert into LIBRARY Values ( 2, 'BOOK2', 950);
insert into LIBRARY Values ( 3, 'BOOK3',850); 
insert into LIBRARY Values ( 4, 'BOOK4', 400);

CREATE OR REPLACE TRIGGER Trig_After_Row
AFTER UPDATE OF BOOK_PRICE ON LIBRARY FOR EACH ROW
BEGIN
INSERT INTO LIBRARY_AUDIT_ROW VALUES (
:old.BOOK_ID,'AfterUpdate(Row)', 
:old.BOOK_NAME,
:old.BOOK_PRICE, CURRENT_TIMESTAMP);
dbms_output.put_line('The old value of updated records added in Library_Audit_Row table.');
 END;
Update LIBRARY set BOOK_PRICE=900 where BOOK_ID=2;
Select * from LIBRARY_AUDIT_ROW;
 Select * from LIBRARY;

insert into LIBRARY Values ( 1, 'BOOK1', 600 );
Update LIBRARY set BOOK_PRICE=1000 where BOOK_ID=1;
Select * from LIBRARY_AUDIT_ROW;
Select * from LIBRARY;

CREATE OR REPLACE TRIGGER Trig_Before_Row
BEFORE DELETE ON LIBRARY FOR EACH ROW
BEGIN
INSERT INTO LIBRARY_AUDIT_ROW VALUES (
    :old.BOOK_ID,'BeforeDelete(Row)', 
    :old.BOOK_NAME,
:old.BOOK_PRICE, CURRENT_TIMESTAMP);
dbms_output.put_line('The old value of Deleted records added in Library_Audit_Row table.');
 END;
 
insert into LIBRARY Values ( 5, 'BOOK5', 700 );
insert into LIBRARY Values ( 6, 'BOOK6', 800 ); 
insert into LIBRARY Values ( 6, 'BOOK6', 300 );
 Delete from LIBRARY where BOOK_ID=5; 
 Delete from LIBRARY where BOOK_ID=6; 
 Select * from LIBRARY_AUDIT_ROW;
Select * from LIBRARY;
