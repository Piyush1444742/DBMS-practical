-- Original table
CREATE TABLE O_RollCall (
    Roll_no NUMBER PRIMARY KEY,
    Name    VARCHAR2(50)
);

-- New table with new data
CREATE TABLE N_RollCall (
    Roll_no NUMBER PRIMARY KEY,
    Name    VARCHAR2(50)
);
DECLARE
    -- Parameterized cursor to check if Roll_no exists in O_RollCall
    CURSOR c_check_exists(p_roll_no NUMBER) IS
        SELECT 1 
        FROM O_RollCall
        WHERE Roll_no = p_roll_no;

BEGIN
  FOR rec IN (SELECT Roll_no, Name FROM N_RollCall) LOOP
    DECLARE
      v_count NUMBER;
    BEGIN
      SELECT COUNT(*) INTO v_count
      FROM O_RollCall
      WHERE Roll_no = rec.Roll_no;

      IF v_count = 0 THEN
        INSERT INTO O_RollCall (Roll_no, Name)
        VALUES (rec.Roll_no, rec.Name);
      END IF;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        NULL;
    END;
  END LOOP;

  COMMIT;
  DBMS_OUTPUT.PUT_LINE('Data merged successfully without duplicates.');
EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
    ROLLBACK;
END;
/
