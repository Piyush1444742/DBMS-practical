-- Original table
CREATE TABLE O_RollCall (
    Roll_no NUMBER PRIMARY KEY,
    Name    VARCHAR2(50)
);

-- New table with new data
CREATE TABLE N_RollCall (
    Roll_no NUMBER PRIMARY KEY,
    Name    VARCHAR2(50)
);
DECLARE
    -- Parameterized cursor to check if Roll_no exists in O_RollCall
    CURSOR c_check_exists(p_roll_no NUMBER) IS
        SELECT 1 
        FROM O_RollCall
        WHERE Roll_no = p_roll_no;

BEGIN
    -- Loop through each record in N_RollCall
    FOR rec IN (SELECT Roll_no, Name FROM N_RollCall) LOOP

        -- Check if Roll_no already exists in O_RollCall
        IF c_check_exists(rec.Roll_no) IS NULL THEN
            -- Insert only if it does not exist
            INSERT INTO O_RollCall(Roll_no, Name)
            VALUES(rec.Roll_no, rec.Name);
        END IF;

    END LOOP;

    COMMIT;
    DBMS_OUTPUT.PUT_LINE('Data merged successfully without duplicates.');

EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
        ROLLBACK;
END;
/
